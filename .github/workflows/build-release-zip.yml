# Builds a release zip on merges to the specified branch.
# The zip is uploaded as an artifact.

name: Build Release Zip

on:
  push:
    branches:
      - develop

jobs:
  build-release-zip:
    name: Build Release Zip
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Set PHP version
        uses: shivammathur/setup-php@v2
        with:
          php-version: "8.0"
          tools: cs2pr
          coverage: none

      - name: composer install
        run: composer install --no-dev -o

      - name: Build release zip
        run: composer run build-release-zip

      - name: Upload release zip
        uses: actions/upload-artifact@v2
        with:
          name: release-zip
          path: release.zip